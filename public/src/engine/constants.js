export const LOCAL_PIECES = ['I', 'J', 'L', 'O', 'S', 'T', 'Z'];

export const SPAWN_X_STD = 3;
export const SPAWN_X_O = 4;
export const SPAWN_Y_STD = -2;
export const SPAWN_POS = {
  default: { x: SPAWN_X_STD, y: SPAWN_Y_STD },
  I: { x: SPAWN_X_STD, y: SPAWN_Y_STD - 1 },
  O: { x: SPAWN_X_O, y: SPAWN_Y_STD }
};

export const COLORS = {
  I: '#5dd9ff',
  J: '#4f6bff',
  L: '#ff9458',
  O: '#ffd952',
  S: '#66ff99',
  T: '#c08cff',
  Z: '#ff5f7a',
  ghost: 'rgba(255,255,255,0.08)',
  garbage: '#555555'
};

export const TETROMINO_SHAPES = {
  T: [
    [[0, 1], [1, 0], [1, 1], [2, 1]],
    [[1, 0], [1, 1], [1, 2], [2, 1]],
    [[0, 1], [1, 1], [2, 1], [1, 2]],
    [[0, 1], [1, 0], [1, 1], [1, 2]]
  ],
  J: [
    [[0, 0], [0, 1], [1, 1], [2, 1]],
    [[1, 0], [2, 0], [1, 1], [1, 2]],
    [[0, 1], [1, 1], [2, 1], [2, 2]],
    [[1, 0], [1, 1], [0, 2], [1, 2]]
  ],
  L: [
    [[2, 0], [0, 1], [1, 1], [2, 1]],
    [[1, 0], [1, 1], [1, 2], [2, 2]],
    [[0, 1], [1, 1], [2, 1], [0, 2]],
    [[0, 0], [1, 0], [1, 1], [1, 2]]
  ],
  S: [
    [[1, 0], [2, 0], [0, 1], [1, 1]],
    [[1, 0], [1, 1], [2, 1], [2, 2]],
    [[1, 1], [2, 1], [0, 2], [1, 2]],
    [[0, 0], [0, 1], [1, 1], [1, 2]]
  ],
  Z: [
    [[0, 0], [1, 0], [1, 1], [2, 1]],
    [[2, 0], [1, 1], [2, 1], [1, 2]],
    [[0, 1], [1, 1], [1, 2], [2, 2]],
    [[1, 0], [0, 1], [1, 1], [0, 2]]
  ],
  I: [
    [[0, 1], [1, 1], [2, 1], [3, 1]],
    [[2, 0], [2, 1], [2, 2], [2, 3]],
    [[0, 2], [1, 2], [2, 2], [3, 2]],
    [[1, 0], [1, 1], [1, 2], [1, 3]]
  ],
  O: [
    [[0, 0], [1, 0], [0, 1], [1, 1]],
    [[0, 0], [1, 0], [0, 1], [1, 1]],
    [[0, 0], [1, 0], [0, 1], [1, 1]],
    [[0, 0], [1, 0], [0, 1], [1, 1]]
  ]
};

// JLSTZ (includes T, J, L, S, Z). Y-DOWN => all Y already inverted.
export const JLSTZ_KICKS = {
  '0>1': [[0,0], [-1,0], [-1,-1], [0, 2], [-1, 2]],
  '1>0': [[0,0], [ 1,0], [ 1, 1], [0,-2], [ 1,-2]],

  '1>2': [[0,0], [ 1,0], [ 1, 1], [0,-2], [ 1,-2]],
  '2>1': [[0,0], [-1,0], [-1,-1], [0, 2], [-1, 2]],

  '2>3': [[0,0], [ 1,0], [ 1,-1], [0, 2], [ 1, 2]],
  '3>2': [[0,0], [-1,0], [-1, 1], [0,-2], [-1,-2]],

  '3>0': [[0,0], [-1,0], [-1, 1], [0,-2], [-1,-2]],
  '0>3': [[0,0], [ 1,0], [ 1,-1], [0, 2], [ 1, 2]]
};

// I-piece SRS+ (tetr.io-style symmetric I kicks), Y-DOWN.
export const I_KICKS = {
  '0>1': [[0,0], [-2,0], [ 1,0], [-2, 1], [ 1,-2]],
  '1>0': [[0,0], [ 2,0], [-1,0], [ 2,-1], [-1, 2]],

  '1>2': [[0,0], [-1,0], [ 2,0], [-1,-2], [ 2, 1]],
  '2>1': [[0,0], [ 1,0], [-2,0], [ 1, 2], [-2,-1]],

  '2>3': [[0,0], [ 2,0], [-1,0], [ 2,-1], [-1, 2]],
  '3>2': [[0,0], [-2,0], [ 1,0], [-2,-1], [ 1, 2]],

  '3>0': [[0,0], [-2,0], [ 1,0], [-2,-1], [ 1, 2]],
  '0>3': [[0,0], [ 2,0], [-1,0], [ 2, 1], [-1,-2]]
};

export const O_KICKS = {
  '0>1': [[0, 0]],
  '1>2': [[0, 0]],
  '2>3': [[0, 0]],
  '3>0': [[0, 0]],
  '1>0': [[0, 0]],
  '2>1': [[0, 0]],
  '3>2': [[0, 0]],
  '0>3': [[0, 0]]
};

export function getKickTable(pieceType, fromState, toState) {
  const key = `${fromState}>${toState}`;
  if (pieceType === 'I') {
    return I_KICKS[key] || [[0, 0]];
  }
  if (pieceType === 'O') {
    return O_KICKS[key] || [[0, 0]];
  }
  return JLSTZ_KICKS[key] || [[0, 0]];
}

export const COMBO_ATTACK = [0, 1, 1, 2, 3, 4, 4, 5, 6, 7, 8];
